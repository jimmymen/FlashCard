<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é£è¡Œç‡ƒæ²¹è®¡åˆ’ & åŠ æ²¹è®¡ç®—å™¨</title>
    <style>
        :root {
            --primary-blue: #0056b3;
            --primary-green: #28a745;
            --bg-color: #f4f7f9;
            --card-bg: #ffffff;
            --border-color: #e0e0e0;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            padding: 20px;
            margin: 0;
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.08);
            overflow: hidden;
        }
        
        /* é€šç”¨æ ·å¼ */
        h2 { margin: 0; padding: 20px; text-align: center; font-size: 1.2rem; }
        .section-header {
            background-color: #eee;
            padding: 10px 20px;
            font-weight: bold;
            color: #555;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .section-body { padding: 20px; }
        label { display: block; font-weight: 600; margin-bottom: 8px; color: #444; font-size: 0.95rem; }
        
        /* è¾“å…¥æ¡†æ ·å¼ */
        input[type="number"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 18px; /* æ‰‹æœºä¸Šæ›´å¤§æ˜“ç‚¹ */
            box-sizing: border-box;
            font-family: monospace; /* æ•°å­—å¯¹é½ */
        }
        input:focus { border-color: var(--primary-blue); outline: none; }
        
        .input-row { display: flex; gap: 15px; margin-bottom: 15px; }
        .input-wrapper { flex: 1; position: relative; }
        .suffix {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #888;
            font-size: 0.9em;
            pointer-events: none;
        }
        .hint { font-size: 12px; color: #888; margin-top: 4px; }

        /* --- æ¨¡å—1ï¼šé£è¡Œè®¡åˆ’ (ç»¿è‰²ä¸»é¢˜) --- */
        .plan-section .section-header { background-color: #e8f5e9; color: #1b5e20; }
        .plan-section input:focus { border-color: var(--primary-green); }
        .plan-result {
            background-color: #f1f8e9;
            border: 1px dashed #a5d6a7;
            padding: 15px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 0.95rem;
        }
        .plan-highlight { font-weight: bold; color: var(--primary-green); }

        /* è¿æ¥ç®­å¤´ */
        .arrow-divider {
            text-align: center;
            color: #ccc;
            font-size: 24px;
            line-height: 1;
            margin: -10px 0;
            position: relative;
            z-index: 1;
        }

        /* --- æ¨¡å—2ï¼šåŠ æ²¹è®¡ç®— (è“è‰²ä¸»é¢˜) --- */
        .calc-section .section-header { background-color: #e3f2fd; color: #0d47a1; }
        
        /* å¯†åº¦æ  */
        .density-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #fafafa;
            padding: 10px 20px;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
        }
        .density-input { width: 80px !important; padding: 5px !important; font-size: 14px !important; text-align: center; }

        /* æœ€ç»ˆç»“æœ */
        .final-result {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin-top: 20px;
            border: 1px solid #90caf9;
        }
        #resultVolume { font-size: 48px; font-weight: 800; color: #d32f2f; display: block; line-height: 1.1; }
        .unit-large { font-size: 20px; color: #555; font-weight: normal; }

        /* æŒ‰é’® */
        .btn-reset {
            width: 100%;
            padding: 15px;
            background: #607d8b;
            color: white;
            border: none;
            font-size: 16px;
            cursor: pointer;
            border-top: 1px solid #546e7a;
        }

        /* è¾…åŠ©æ˜¾ç¤ºç£…çš„ç°è‰²å°å­— */
        .lbs-display {
            display: block;
            font-size: 0.85em;
            color: #666;
            margin-top: 2px;
            text-align: right;
        }
    </style>
</head>
<body>

<div class="container">
    
    <!-- æ¨¡å— 1: é£è¡Œè®¡åˆ’ -->
    <div class="plan-section">
        <div class="section-header">
            <span>ğŸ“‹</span> é˜¶æ®µä¸€ï¼šé£è¡Œç‡ƒæ²¹è®¡åˆ’
        </div>
        <div class="section-body">
            <!-- é£è¡Œæ—¶é—´ -->
            <label>é¢„è®¡é£è¡Œæ—¶é—´ (Flight Time)</label>
            <div class="input-wrapper">
                <input type="number" id="flightTime" placeholder="ä¾‹å¦‚: 225 æˆ– 0225" oninput="calculatePlan()">
                <div class="hint">è¾“å…¥æ ¼å¼ HHMMï¼Œä¾‹å¦‚ 225 ä»£è¡¨ 2å°æ—¶25åˆ†</div>
            </div>

            <br>

            <!-- è€—æ²¹ç‡ & ä¿ç•™æ²¹é‡ -->
            <div class="input-row">
                <div class="input-wrapper">
                    <label>è€—æ²¹ç‡ (T/h)</label>
                    <input type="number" id="fuelFlow" value="1.2" step="0.1" oninput="calculatePlan()">
                </div>
                <div class="input-wrapper">
                    <label>è½åœ°å‰©ä½™ (T)</label>
                    <input type="number" id="reserves" value="3.0" step="0.1" oninput="calculatePlan()">
                </div>
            </div>

            <!-- è®¡åˆ’ç»“æœå±•ç¤º -->
            <div class="plan-result">
                <div>ç©ºä¸­è€—æ²¹: <span id="dispTrip" class="plan-highlight">0.0</span> å¨ <span id="dispTripLbs" class="lbs-display">(0 lbs)</span></div>
                <div style="margin-top:8px; border-top:1px solid #ccc; padding-top:8px;">
                    <strong>ç›®æ ‡æ€»æ²¹é‡: <span id="dispTotal" class="plan-highlight" style="font-size:1.2em">0.0</span> å¨</strong>
                    <span id="dispTotalLbs" class="lbs-display">(0 lbs)</span>
                </div>
                <div style="font-size:12px; color:#888; margin-top:5px;">* æ­¤æ•°å€¼å·²è‡ªåŠ¨å¡«å…¥ä¸‹æ–¹è®¡ç®—å™¨</div>
            </div>
        </div>
    </div>

    <!-- è¿æ¥ç®­å¤´ -->
    <div class="arrow-divider">â¬‡</div>

    <!-- æ¨¡å— 2: åŠ æ²¹è®¡ç®—å™¨ -->
    <div class="calc-section">
        <div class="section-header">
            <span>â›½</span> é˜¶æ®µäºŒï¼šåŠ æ²¹ä½“ç§¯è®¡ç®—
        </div>
        
        <!-- å¯†åº¦è®¾ç½® -->
        <div class="density-bar">
            <span>ç‡ƒæ²¹å¯†åº¦ (Density kg/L)</span>
            <input type="number" id="density" value="0.800" step="0.001" class="density-input" oninput="calculateVolume()">
        </div>

        <div class="section-body">
            <!-- ç›®æ ‡æ²¹é‡ (å¯è¢«ä¸Šæ–¹è”åŠ¨ï¼Œä¹Ÿå¯æ‰‹åŠ¨ä¿®æ”¹) -->
            <label>1. ç›®æ ‡æ€»æ²¹é‡ (Target Fuel)</label>
            <div class="input-row">
                <div class="input-wrapper">
                    <input type="number" id="targetTons" placeholder="å¨ (T)" step="0.1" oninput="syncUnits('target', 'tons')">
                    <span class="suffix">å¨</span>
                </div>
                <div class="input-wrapper">
                    <input type="number" id="targetLbs" placeholder="ç£… (Lbs)" step="100" oninput="syncUnits('target', 'lbs')">
                    <span class="suffix">ç£…</span>
                </div>
            </div>

            <!-- é£æœºå‰©ä½™æ²¹é‡ -->
            <label>2. é£æœºå½“å‰å‰©ä½™æ²¹é‡ (Remaining)</label>
            <div class="input-row">
                <div class="input-wrapper">
                    <input type="number" id="remTons" placeholder="å¨ (T)" step="0.1" oninput="syncUnits('rem', 'tons')">
                    <span class="suffix">å¨</span>
                </div>
                <div class="input-wrapper">
                    <input type="number" id="remLbs" placeholder="ç£… (Lbs)" step="100" oninput="syncUnits('rem', 'lbs')">
                    <span class="suffix">ç£…</span>
                </div>
            </div>

            <!-- æœ€ç»ˆç»“æœ -->
            <div class="final-result">
                <label style="margin-bottom:5px; color:#004a99;">å®é™…åŠ æ³¨ä½“ç§¯ / Uplift Volume</label>
                <span id="resultVolume">0</span>
                <span class="unit-large">å‡ (L)</span>
                <div style="margin-top:10px; font-size: 14px; color: #555;">
                    é¢„è®¡åŠ æ³¨é‡é‡: <span id="resultWeight">0</span> kg
                </div>
            </div>
        </div>
    </div>

    <button class="btn-reset" onclick="resetAll()">é‡ç½®æ‰€æœ‰æ•°æ®</button>

</div>

<script>
    // --- å¸¸é‡ ---
    const LBS_PER_TON = 2204.62262;
    const KG_PER_TON = 1000;

    // --- DOM å…ƒç´ å¼•ç”¨ ---
    const els = {
        // è®¡åˆ’éƒ¨åˆ†
        flightTime: document.getElementById('flightTime'),
        fuelFlow: document.getElementById('fuelFlow'),
        reserves: document.getElementById('reserves'),
        dispTrip: document.getElementById('dispTrip'),
        dispTripLbs: document.getElementById('dispTripLbs'),
        dispTotal: document.getElementById('dispTotal'),
        dispTotalLbs: document.getElementById('dispTotalLbs'),
        
        // è®¡ç®—éƒ¨åˆ†
        density: document.getElementById('density'),
        targetTons: document.getElementById('targetTons'),
        targetLbs: document.getElementById('targetLbs'),
        remTons: document.getElementById('remTons'),
        remLbs: document.getElementById('remLbs'),
        resVol: document.getElementById('resultVolume'),
        resWeight: document.getElementById('resultWeight')
    };

    // --- é€»è¾‘ 1: é£è¡Œè®¡åˆ’è®¡ç®— ---
    function calculatePlan() {
        const rawTime = els.flightTime.value; // è·å–å­—ç¬¦ä¸²ï¼Œå¦‚ "225"
        const flow = parseFloat(els.fuelFlow.value) || 0;
        const res = parseFloat(els.reserves.value) || 0;

        if (!rawTime) return; // å¦‚æœæ²¡æœ‰æ—¶é—´ï¼Œæš‚ä¸è®¡ç®—

        // è§£ææ—¶é—´ HHMM
        let hours = 0;
        let minutes = 0;
        
        // å°†è¾“å…¥å½“åšæ•°å­—å¤„ç† (ä¾‹å¦‚ 225 -> 225)
        const timeNum = parseInt(rawTime, 10);
        if (!isNaN(timeNum)) {
            hours = Math.floor(timeNum / 100); // 225 / 100 = 2
            minutes = timeNum % 100;           // 225 % 100 = 25
        }

        // è½¬æ¢ä¸ºåè¿›åˆ¶å°æ—¶
        const decimalTime = hours + (minutes / 60);

        // è®¡ç®—
        const tripFuel = decimalTime * flow;
        const totalFuel = tripFuel + res;

        // æ›´æ–°è®¡åˆ’éƒ¨åˆ†çš„UIæ˜¾ç¤º
        updatePlanUI(tripFuel, totalFuel);

        // **å…³é”®è”åŠ¨**: å°†è®¡ç®—å‡ºçš„æ€»æ²¹é‡è‡ªåŠ¨å¡«å…¥ä¸‹æ–¹ "ç›®æ ‡æ€»æ²¹é‡ (å¨)"
        els.targetTons.value = totalFuel.toFixed(3); // ä¿ç•™3ä½å°æ•°ç²¾åº¦
        
        // è§¦å‘ä¸‹æ–¹è®¡ç®—å™¨çš„åŒæ­¥é€»è¾‘ (æŠŠå¨æ¢ç®—æˆç£…ï¼Œå¹¶è®¡ç®—æœ€ç»ˆå‡æ•°)
        syncUnits('target', 'tons'); 
    }

    function updatePlanUI(trip, total) {
        // æ ¼å¼åŒ–æ˜¾ç¤º
        els.dispTrip.textContent = trip.toFixed(2);
        els.dispTripLbs.textContent = `(${(trip * LBS_PER_TON).toLocaleString('en-US', {maximumFractionDigits: 0})} lbs)`;
        
        els.dispTotal.textContent = total.toFixed(2);
        els.dispTotalLbs.textContent = `(${(total * LBS_PER_TON).toLocaleString('en-US', {maximumFractionDigits: 0})} lbs)`;
    }


    // --- é€»è¾‘ 2: åŠ æ²¹å•ä½åŒæ­¥ & ä½“ç§¯è®¡ç®— ---
    
    // å½“è¾“å…¥æ¡†å˜åŒ–æ—¶ï¼ŒåŒæ­¥ å¨ <-> ç£…
    function syncUnits(type, unit) {
        const tonsInput = type === 'target' ? els.targetTons : els.remTons;
        const lbsInput = type === 'target' ? els.targetLbs : els.remLbs;

        if (unit === 'tons') {
            const val = parseFloat(tonsInput.value);
            if (!isNaN(val)) {
                lbsInput.value = (val * LBS_PER_TON).toFixed(0); 
            } else {
                lbsInput.value = '';
            }
        } else {
            const val = parseFloat(lbsInput.value);
            if (!isNaN(val)) {
                tonsInput.value = (val / LBS_PER_TON).toFixed(3);
            } else {
                tonsInput.value = '';
            }
        }
        // æ— è®ºæ”¹äº†å“ªä¸ªï¼Œæœ€åéƒ½å»ç®—ä½“ç§¯
        calculateVolume();
    }

    // æœ€ç»ˆè®¡ç®—ä½“ç§¯
    function calculateVolume() {
        const density = parseFloat(els.density.value) || 0.8;
        
        const targetT = parseFloat(els.targetTons.value) || 0;
        const remT = parseFloat(els.remTons.value) || 0;

        let diffTons = targetT - remT;
        if (diffTons < 0) diffTons = 0;

        const diffKg = diffTons * KG_PER_TON;
        const volume = diffKg / density;

        // æ›´æ–°ç»“æœ
        els.resVol.textContent = volume.toLocaleString('en-US', { maximumFractionDigits: 0 });
        els.resWeight.textContent = diffKg.toLocaleString('en-US', { maximumFractionDigits: 0 });
    }

    // --- é‡ç½® ---
    function resetAll() {
        // æ¸…ç©ºæ–‡æœ¬æ¡†
        const inputs = document.querySelectorAll('input');
        inputs.forEach(input => input.value = '');
        
        // æ¢å¤é»˜è®¤å€¼
        els.density.value = "0.800";
        els.fuelFlow.value = "1.2";
        els.reserves.value = "3.0";
        
        // æ¸…ç©ºæ˜¾ç¤ºæ–‡æœ¬
        els.resVol.textContent = "0";
        els.resWeight.textContent = "0";
        els.dispTrip.textContent = "0.0";
        els.dispTotal.textContent = "0.0";
        els.dispTripLbs.textContent = "(0 lbs)";
        els.dispTotalLbs.textContent = "(0 lbs)";
    }

</script>

</body>
</html>
